/* JSON接口播放 json */
var thythemebjid=["#15E3CE","#28FF28","#B7DAFF"];
var thythemebj = thythemebjid[parseInt(Math.random()*thythemebjid.length)];
var thynext = next[1];

//JSON一组
var xmlhttp = new XMLHttpRequest();
xmlhttp.onreadystatechange = function() {
  if (this.readyState == 4 && this.status == 200) {
    var myObj = JSON.parse(this.responseText);
var thyurl = myObj.url; //dplayer
if(myObj.code=="200"){
    var webdata = {
		set:function(key,val){
			window.sessionStorage.setItem(key,val);
		},
		get:function(key){
			return window.sessionStorage.getItem(key);
		},
		del:function(key){
			window.sessionStorage.removeItem(key);
		},
		clear:function(key){
			window.sessionStorage.clear();
		}
	};
    var type='normal';
    var live=false;
    if(thyurl.indexOf('.m3u8')>-1){
        type='hls';
        live=true;
    }
    else if(thyurl.indexOf('magnet:')>-1){
        type='webtorrent';
    }
    else if(thyurl.indexOf('.flv')>-1){
        type='flv';
    }
    else if(thyurl.indexOf('.mpd')>-1){
        type='dash';
    }
    else if(thyurl.indexOf('janan.net')>-1){
        type='auto';
        //type='hls';
    }
    else{
        type='auto';
    }

function GetQueryString(name)
	{
		 var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
		 var r = window.location.search.substr(1).match(reg);
		 if(r!=null)return  unescape(r[2]); return null;
	}
  if(thydomain.indexOf("type=h5")>0 || thydomain.indexOf("type=video")>0){
  var ismobile = navigator.userAgent.match(/iPad|iPhone|Android|Linux|iPod/i) != null; //H5
  }
  else if(thydomain.indexOf("type=dp")>0 || thydomain.indexOf("type=player")>0){
  var ismobile = navigator.userAgent.match(/iPad0|iPhone0|Android0|Linux0|iPod/i) != null; //dplayer
  }
  else{
  var ismobile = navigator.userAgent.match(/iPad|iPhone|Android0|Linux0|iPod/i) != null; //安卓:dplayer 苹果:H5
  }
  //
  if(ismobile){
	document.getElementById('playerCnt').innerHTML = '<video src="'+thyurl+'" controls="controls" autoplay="autoplay" width="100%" height="100%" x-webkit-airplay="allow" poster="'+thydata.pic+'"></video>';
      }else {
    var dp = new DPlayer({
        container: document.getElementById('playerCnt'),
        autoplay: true,
        screenshot: false,
        video: {
            url: thyurl,
            live: live,
            type:type,
			pic: thydata.pic,
        },
         volume: 1.0,
         preload: 'auto',
         theme: thythemebj,
         //theme: '#15E3CE',
		 logo: thydata.logo,
        contextmenu: [
        {
            text: '桃花源',
            link: 'https://www.baidu.com/',
        },
        ]
    });
       }
    if(thyurl.indexOf('.m3u8')>-1){
	dp.seek(webdata.get('pay'+thyurl));
	setInterval(function(){
		webdata.set('pay'+thyurl,dp.video.currentTime);
	},1000);
    }
    else if(thyurl.indexOf('.mp4')>-1){
	dp.seek(webdata.get('pay'+thyurl));
	setInterval(function(){
		webdata.set('pay'+thyurl,dp.video.currentTime);
	},1000);
    }
	else if(thyurl.indexOf('.flv')>-1){
	dp.seek(webdata.get('pay'+thyurl));
	setInterval(function(){
		webdata.set('pay'+thyurl,dp.video.currentTime);
	},1000);
    }
	else if(thyurl.indexOf('qq.com')>-1){
	dp.seek(webdata.get('pay'+thyurl));
	setInterval(function(){
		webdata.set('pay'+thyurl,dp.video.currentTime);
	},1000);
    }else{
    }
	//下一集
    if(thydomain.indexOf("next=")>0){
    dp.on('ended', function (){
    if(thynext!=''){
		dp.notice('正在自动为您播放下一集');
		top.location.href = thynext;
    }
    });
	}
    else{
    dp.on('ended', function (){
    if(thynext!=''){
		dp.notice('播放结束啦=。=');
    }
    });
    }
	//
//状态
}
else if(myObj.code=="404"){
document.writeln("<style>body{width:100%;height:100%;padding:0;margin:0;background-color:#444;font-size:14px;}h3{font-size:60px;color:#eee;text-align:center;padding-top:30px;font-weight:normal;}button {font-size: 22px;margin-top: 1.5em;padding: 0.5em 1em;letter-spacing: 1px;font-family: \'Lato\', sans-serif;color: white;background-color: transparent;border: 0;cursor: pointer;z-index: 999;border: 2px solid white;border-radius: 5px;text-shadow: 4px 4px 4px rgba(0, 0, 0, 0.2);transition: opacity 0.2s ease;}button:hover {opacity: 0.7;}button:focus {outline: 0;}</style>");
document.writeln("<div style=\'text-align:center;\'><a href=\'javascript:void(0);\' onClick=\'window.location.reload()\' target=\'_self\' title=\'重试\'><button>点击重试</button></a></div>");
document.writeln("<br><div style=\'text-align:center;color:#eee;\'>如果无法播放请重新刷新页面，或者切换线路。</div>");
     document.oncontextmenu = function () { 
         //alert('请重试');
         return false; 
         };
        document.onkeydown = function () {
            if (window.event && window.event.keyCode == 123) {
                event.keyCode = 0;
                event.returnValue = false;
                //alert('请重试');
                return false;
            }
        };
}
else if(myObj.code=="500"){
document.writeln("<style>body{width:100%;height:100%;padding:0;margin:0;background-color:#444;font-size:14px;}h3{font-size:60px;color:#eee;text-align:center;padding-top:30px;font-weight:normal;}button {font-size: 22px;margin-top: 1.5em;padding: 0.5em 1em;letter-spacing: 1px;font-family: \'Lato\', sans-serif;color: white;background-color: transparent;border: 0;cursor: pointer;z-index: 999;border: 2px solid white;border-radius: 5px;text-shadow: 4px 4px 4px rgba(0, 0, 0, 0.2);transition: opacity 0.2s ease;}button:hover {opacity: 0.7;}button:focus {outline: 0;}</style>");
document.writeln("<div style=\'text-align:center;\'><a href=\'javascript:void(0);\' onClick=\'window.location.reload()\' target=\'_self\' title=\'重试\'><button>点击重试</button></a></div>");
document.writeln("<br><div style=\'text-align:center;color:#eee;\'>如果无法播放请重新刷新页面，或者切换线路。①</div>");
     document.oncontextmenu = function () { 
         //alert('请重试');
         return false; 
         };
        document.onkeydown = function () {
            if (window.event && window.event.keyCode == 123) {
                event.keyCode = 0;
                event.returnValue = false;
                //alert('请重试');
                return false;
            }
        };
}
else{
document.writeln("<style>body{width:100%;height:100%;padding:0;margin:0;background-color:#444;font-size:14px;}h3{font-size:60px;color:#eee;text-align:center;padding-top:30px;font-weight:normal;}button {font-size: 22px;margin-top: 1.5em;padding: 0.5em 1em;letter-spacing: 1px;font-family: \'Lato\', sans-serif;color: white;background-color: transparent;border: 0;cursor: pointer;z-index: 999;border: 2px solid white;border-radius: 5px;text-shadow: 4px 4px 4px rgba(0, 0, 0, 0.2);transition: opacity 0.2s ease;}button:hover {opacity: 0.7;}button:focus {outline: 0;}</style>");
document.writeln("<div style=\'text-align:center;\'><a href=\'javascript:void(0);\' onClick=\'window.location.reload()\' target=\'_self\' title=\'重试\'><button>点击重试或切换线路，浏览器</button></a></div>");
document.writeln("<br><div style=\'text-align:center;color:#eee;\'>正在修复中！</div>");
     document.oncontextmenu = function () { 
         //alert('请重试');
         return false; 
         };
        document.onkeydown = function () {
            if (window.event && window.event.keyCode == 123) {
                event.keyCode = 0;
                event.returnValue = false;
                //alert('请重试');
                return false;
            }
        };
}
//JSON二组
  }
};
xmlhttp.open("GET", "https://json.m3u8.tv:7788/json.php?url="+urle[1], true);
xmlhttp.send();
//隔开
if ((navigator.userAgent.indexOf('MSIE') >= 0)
			|| (navigator.userAgent.indexOf('Trident') >= 0)) {
		alert("\u517c\u5bb9\u6a21\u5f0f\u0020\u6613\u4ea7\u751f\u64ad\u653e\u95ee\u9898\uff0c\u8bf7\u5c06\u6d4f\u89c8\u5668\u8bbe\u7f6e\u4e3a\u0020\u6781\u901f\u6a21\u5f0f\uff01");
     }
	try{
		//document.getElementById('playerCnt').style.height = parent.MacPlayer.Height + 'px';
	}
	catch(e){}
